horde_nations_list_effect = {
	custom_description = {
		every_country = {
   			limit = {
   				capital = {
					OR = {
						region = region:steppes_region
						region = region:khorasan_region
						region = region:mongolia_region
						region = region:xinjiang_region
						area = area:bursol_area
						area = area:suzun_area
						area = area:omsk_area
						area = area:kulykol_area
						area = area:bashkiria_area
						area = area:bolghar_area
						province_definition = province_definition:samara_province
						province_definition = province_definition:saratov_province
						province_definition = province_definition:atkarsk_province
					}
				}
				government_type = government_type:steppe_horde
 			}
    			add_to_global_variable_list = {
        			name = horde_nations_list
        			target = this
    			}
		}
	}
}

horde_nations_list_monthly_check_effect = {
	custom_description = {
		clear_global_variable_list = horde_nations_list
		every_country = {
   			limit = {
   				capital = {
					OR = {
						region = region:steppes_region
						region = region:khorasan_region
						region = region:mongolia_region
						region = region:xinjiang_region
						area = area:bursol_area
						area = area:suzun_area
						area = area:omsk_area
						area = area:kulykol_area
						area = area:bashkiria_area
						area = area:bolghar_area
						province_definition = province_definition:samara_province
						province_definition = province_definition:saratov_province
						province_definition = province_definition:atkarsk_province
					}
				}
				government_type = government_type:steppe_horde
 			}
    			add_to_global_variable_list = {
        			name = horde_nations_list
        			target = this
    			}
		}
	}
}

start_herd_check_effect = {
	custom_description = {
		every_country = {
   			limit = {
   				capital = {
					OR = {
						region = region:steppes_region
						region = region:khorasan_region
						region = region:mongolia_region
						region = region:xinjiang_region
						area = area:bursol_area
						area = area:suzun_area
						area = area:omsk_area
						area = area:kulykol_area
						area = area:bashkiria_area
						area = area:bolghar_area
						province_definition = province_definition:samara_province
						province_definition = province_definition:saratov_province
						province_definition = province_definition:atkarsk_province
					}
				}
				government_type = government_type:steppe_horde
 			}
			set_variable = {
				name = current_herd
				value = 50
				max = 100000
				min = 0
			}
		}
	}
}

monthly_herd_check_effect = {
	custom_description = {
		every_country = {
   			limit = {
   				has_variable = current_herd
 			}
			change_variable = {
				name = current_herd
				add = {
					value = monthly_income_trade_and_tax
					multiply = 0.002
				}
			}
			#round_variable = { 
			#	name = current_herd 
			#	nearest = var:current_herd 
			#} #Round the var
			#set_variable = {
			#	name = current_herd
			#	value = {
			#		value = var:current_herd
			#		ceiling = yes
			#	}
			#}
		}
	}
}

strength_horde_start_effect = {
	custom_description = {
		every_country = {
			limit = {
				government_type = government_type:steppe_horde
			}
			add_to_global_variable_list = { name = horde_nations_s_list target = this }

		}
		ordered_in_global_list = {  
			variable = horde_nations_s_list
			limit = { is_subject = no }
			order_by = {
				
				add = {
					value = military_strength
				}
				add = {
					value = monthly_income_trade_and_tax
				}
			} 
			max = 1
			check_range_bounds = no 
			situation:the_steppe = {
				set_variable = {
					name = strongest_strongest_horde_variable
					value = prev
				}
				set_variable = {
					name = strongest_horde_total_score_variable
					value = {
						add = var:strongest_horde_variable.military_strength
						add = var:strongest_horde_variable.monthly_income_trade_and_tax 
					}
				}
			}
			#trigger_event_non_silently =
		}
		ordered_in_global_list = {  
			variable = horde_nations_s_list
			limit = { 
				this != situation:the_steppe.var:strongest_horde_variable 
				is_subject = no
			}
			order_by = {
					
				add = {
					value = military_strength
				}
				add = {
					value = monthly_income_trade_and_tax
				}
			} 
			max = 1
			check_range_bounds = no 
			situation:the_steppe = {
				set_variable = {
					name = second_strongest_strongest_horde_variable
					value = prev
				}
				set_variable = {
					name = second_strongest_strongest_horde_total_score_variable
					value = {
						add = var:second_strongest_strongest_horde_variable.military_strength
						add = var:second_strongest_strongest_horde_variable.monthly_income_trade_and_tax
					}
				}
			}
		}
		ordered_in_global_list = {  
			variable = horde_nations_s_list
			limit = {
				this != situation:rise_of_the_ottomans.var:strongest_horde_variable 
				this != situation:rise_of_the_ottomans.var:second_strongest_strongest_horde_variable 
				is_subject = no
			}
			order_by = {
					
				add = {
					value = military_strength
				}
				add = {
					value = monthly_income_trade_and_tax
				}
			} 
			max = 1
			check_range_bounds = no 
			situation:the_steppe = {
				set_variable = {
					name = third_strongest_strongest_horde_variable
					value = prev
				}
				set_variable = {
					name = third_strongest_strongest_horde_total_score_variable
					value = {
						add = var:third_strongest_strongest_horde_variable.military_strength
						add = var:third_strongest_strongest_horde_variable.monthly_income_trade_and_tax
					}
				}
			}
		}
	}
}

recalculate_the_strength_horde_monthly_effect  = {
	custom_description = {
		ordered_in_global_list = {  
			variable = horde_nations_s_list
			limit = { is_subject = no }
			order_by = {
			
				add = {
					value = military_strength
				}
				add = {
					value = monthly_income_trade_and_tax
				}
				if = {
					limit = { is_subject = yes }
					multiply = 0.75
				}
			} 
			max = 1
			check_range_bounds = no 
			situation:the_steppe = {
				set_variable = {
					name = strongest_strongest_horde_variable
					value = prev
				}
				set_variable = {
					name = strongest_horde_total_score_variable
					value = {
						add = var:strongest_horde_variable.military_strength
						add = var:strongest_horde_variable.monthly_income_trade_and_tax 
					}
				}
			}
		}	
		if = {
			limit = {
				global_variable_list_size = {
					name = horde_nations_s_list
					value > 1
				}
			}
			ordered_in_global_list = {	#2nd strongest  
				variable = horde_nations_s_list
				limit = { 
					this != situation:the_steppe.var:strongest_horde_variable 
					is_subject = no
				}
				order_by = {
					
					add = {
						value = military_strength
					}
					add = {
						value = monthly_income_trade_and_tax
					}
				} 
				max = 1
				check_range_bounds = no 
				situation:the_steppe = {
					set_variable = {
						name = second_strongest_strongest_horde_variable
						value = prev
					}
					set_variable = {
						name = second_strongest_strongest_horde_total_score_variable
						value = {
							add = var:second_strongest_strongest_horde_variable.military_strength
							add = var:second_strongest_strongest_horde_variable.monthly_income_trade_and_tax
						}
					}
				}
			}
		}
		else = {
			situation:the_steppe = {
				remove_variable = second_strongest_strongest_horde_variable
				remove_variable = second_strongest_strongest_horde_total_score_variable
			}
		}

		if = {
			limit = {
				global_variable_list_size = {
					name = horde_nations_s_list
					value > 2
				}
			}
			ordered_in_global_list = { #3rd Strongest 
				variable = horde_nations_s_list
				limit = {
					this != situation:rise_of_the_ottomans.var:strongest_horde_variable 
					this != situation:rise_of_the_ottomans.var:second_strongest_strongest_horde_variable 
					is_subject = no
				}
				order_by = {
					
					add = {
						value = military_strength
					}
					add = {
						value = monthly_income_trade_and_tax
					}
				} 
				max = 1
				check_range_bounds = no 
				situation:the_steppe = {
					set_variable = {
						name = third_strongest_strongest_horde_variable
						value = prev
					}
					set_variable = {
						name = third_strongest_strongest_horde_total_score_variable
						value = {
							add = var:third_strongest_strongest_horde_variable.military_strength
							add = var:third_strongest_strongest_horde_variable.monthly_income_trade_and_tax
						}
					}
				}
			}
		}
		else = {
			situation:the_steppe = {
				remove_variable = third_strongest_strongest_horde_variable
				remove_variable = third_strongest_strongest_horde_total_score_variable
			}
		}
	}
}